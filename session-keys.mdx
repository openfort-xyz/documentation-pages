export const description =
  "In this guide, we will talk about session keys. First a general overview and then we will show their role in Openfort."

# Session Keys

In the realm of web3 games, session keys can be a crucial aspect for securing player accounts as well as improving the overall gaming experience.
Session keys can be used to authenticate players, authorize their actions within the game, and grant limited permissions to their web3 accounts.

## Overview

Openfort has developed a robust internal infrastructure for handling session keys, ensuring secure and seamless player authentication.
This infrastructure includes automated systems for generating, handling, and validating session keys, all managed through Openfort's API.

Session keys are cryptographic keys used to establish a secure connection between a player's device, the game server and the user's web3 account.
They are generated inside the player's device and are used to authenticate requests from the player. Session keys are short-lived and typically expire after a certain period of inactivity or when the player logs out.

To better understand how session keys work on Openfort, you can read our blog post [Technical Dive: Session Keys](https://www.openfort.xyz/blog/technical-dive-session-keys).

## Registering Session Keys

A player can register new session keys through the following Openfort API endpoint.
The first example below shows the call to register a session key for a player using a custodial account.
As they do not hold the private key of the administrator/owner wallet, no further actions are required from the player.
The created session key would be valid since the 25th of May 2023 at 7:50 GMT (timestamp `1685001000`) and last for 1 hour (timestamp `1685004600`).
For a useful resource to calculate timestamps online, visit [UNIX Timestamp](https://www.unixtimestamp.com/).

<CodeGroup title="Register a session key (custodial accounts)" tag="POST" label="/v1/sessions">
  ```bash {{ title: 'cURL' }}
    curl https://api.openfort.xyz/v1/sessions \
    -H "Authorization: Bearer $YOUR_SECRET_KEY" \
    -d player=pla_... \
    -d address=0x76e6...9341 \
    -d chain_id=80001 \
    -d valid_until=1685004600 \
    -d valid_after=1685001000 \
    -d policy=pol_...
  ```
</CodeGroup>

The second example below, is an example of the API call that players with non-custodial accounts would use.
Notice the extra `external_owner_address` parameter needed to indicate the actual [EOA](https://ethereum.org/en/developers/docs/accounts/) that will sign the authorization of the action.
As they hold the private key of the administrator/owner wallet, the response of such call would contain an extra
element called `next_action` which will need to be signed by the players EOA and returned in a successive API call.

<CodeGroup title="Register a session key (non-custodial accounts)" tag="POST" label="/v1/sessions">
  ```bash {{ title: 'cURL' }}
    curl https://api.openfort.xyz/v1/sessions \
    -H "Authorization: Bearer $YOUR_SECRET_KEY" \
    -d player=pla_... \
    -d address=0x76e6...9341 \
    -d chain_id=80001 \
    -d valid_until=1685004600 \
    -d valid_after=1685001000 \
    -d policy=pol_...
    -d external_owner_address=0x8a16...CE4a
  ```
</CodeGroup>

Once the content of the `next_action` parameter above is signed by the player's wallet,
it has to be sent using the endpoint `/v1/sessions/:session/signature` as shown below:

<CodeGroup title="Request" tag="POST" label="/v1/sessions/:session/signature">
  ```bash {{ title: 'cURL' }}
    curl https://api.openfort.xyz/v1/sessions/ses_.../signature \
    -H "Authorization: Bearer $YOUR_PUBLISHABLE_KEY" \
    -d "signature=xyz..."
  ```
</CodeGroup>

For more information about how to use the sesion key endpoints, you can visit our [API documentation](https://www.openfort.xyz/docs/api/sessions).
